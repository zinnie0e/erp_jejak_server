<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.guru.erpserver.mapper.dbjejak.MonthClosingMapper">

	<!-- 도서별 원가계산서 -->
	<select id="selBookCostStatement1" resultType="monthClosingVO">
		SELECT count(uid) AS count
		FROM jejak.TMPLIST2
		WHERE bdate <![CDATA[ > ]]> #{date1}
			AND bdate <![CDATA[ < ]]> #{date2}
		    AND bucode = 0
	</select>
	
	<select id="selBookCostStatement2" resultType="monthClosingVO">
		SELECT a.uid, a.bdate, a.crnum, a.bucode, b.bname, b.bcode, b.bnum
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b 
		WHERE a.bdate <![CDATA[ > ]]> #{date1}
			AND a.bdate <![CDATA[ < ]]> #{date2}
		    AND a.bucode = 0 
		    AND a.listid = b.uid 
		ORDER BY a.crnum DESC 
		LIMIT #{lm_s}, #{lm_t}
	</select>
	
	<select id="selBookCostStatement3" resultType="monthClosingVO">
		SELECT count(uid) AS yjtag
		FROM jejak.TMPLIST3 
		WHERE listid = #{uid}
			AND ycost = 0 
		    AND (jm > 0 OR yb > 0)
	</select>
	
	<select id="selBookCostStatement4" resultType="monthClosingVO">
		SELECT a.uid, b.bcode, b.btype, c.sbsbph1, c.sbsbph2, c.sbsbph3, c.sbsbph4, c.sbsbjh1, c.sbsbjh2, c.sbsbjh3, c.sbsbjh4, c.sbsbpg1, c.sbsbpg2, c.sbsbpg3, c.sbsbpg4
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c
		WHERE a.uid = #{uid}
			AND a.listid = b.uid
			AND b.bcode = c.sbbook
		LIMIT 1
	</select>
	
	<select id="selBookCostStatement5" resultType="monthClosingVO">
		SELECT a.crnum, a.bdate, a.m1, a.m2, a.m3, b.bnum, b.bname, b.bcode, b.bmyun, c.sbpanh, c.sbjanh, c.sbuprc, d.wcname 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c, jejak.KSWCUST0 AS d 
		WHERE a.uid = #{uid}
			AND a.bucode = 0 
			AND a.listid = b.uid 
			AND b.bcode = c.SBBOOK 
			AND a.m1 = d.wccode
	</select>
	
	<select id="selBookCostStatement6" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{uid} 
		ORDER BY uid ASC
	</select>	
	
	<select id="selBookCostStatement7" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{bur_uid} 
		ORDER BY uid ASC
	</select>
	
	<select id="selBookCostStatement8" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{uid} 
		ORDER BY uid ASC
	</select>	
	
	<select id="selBookCostStatement9" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{bur_uid} 
		ORDER BY uid ASC
	</select>	
	
	<select id="selBookCostStatement10" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWCUST0 
		WHERE wccode = #{m3}
	</select>	
	
	<select id="selBookCostStatement11" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE7 
		WHERE crnum7 = #{uid} 
		ORDER BY uid ASC
	</select>	
	
	<select id="selBookCostStatement12" resultType="monthClosingVO">
		SELECT m3 
		FROM jejak.TMPLIST2
		WHERE uid = #{bur_uid}
	</select>
		
	<select id="selBookCostStatement13" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWCUST0
		WHERE wccode = #{jebon}
	</select>	
	
	<select id="selBookCostStatement14" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE7 
		WHERE uid = #{bur_uid}
	</select>
		
	<select id="selBookCostStatement15" resultType="monthClosingVO">
		SELECT a.*, b.wcname 
		FROM jejak.BITABLE8 AS a, jejak.KSWCUST0 AS b 
		WHERE a.crnum8 = #{uid} 
			AND a.ccode8 = b.wccode
	</select>
		
	<select id="selBookCostStatement16" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{uid} 
			AND bitag = 1
	</select>
		
	<select id="selBookCostStatement17" resultType="monthClosingVO">
		SELECT wcname 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{ccode9}
	</select>	
	
	<select id="selBookCostStatement18" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TWONGA 
		WHERE jenum = #{uid} 
			AND jabtag = 0
	</select>	
	
	<insert id="inBookCostStatement19" parameterType="monthClosingVO">
		INSERT INTO jejak.TWONGA (
			jenum, jabtag
		) VALUES (
			#{uid}, 0
		)
	</insert>	
	
	<update id="upBookCostStatement20" parameterType="monthClosingVO">
		UPDATE jejak.TWONGA SET 
			w21 = #{new_21} 
		WHERE jenum = #{uid} 
			AND jabtag = 0
	</update>
	
	<select id="selBookCostStatement21" resultType="monthClosingVO">
		SELECT sbdung, sbinse, sbjjgb 
		FROM jejak.KSCBOOK0 
		WHERE sbbook LIKE #{bookcode}
	</select>
	
	<select id="selBookCostStatement22" resultType="monthClosingVO">
		SELECT sthaly 
		FROM jejak.KSCTABL0 
		WHERE stcudn LIKE '026' 
			AND stdsdn LIKE #{sthaly}	
	</select>
	
	<select id="selBookCostStatement23" resultType="monthClosingVO">
		UPDATE jejak.TWONGA SET 
			wtotal = #{total_cost}, wdanga = #{total_danga} 
		WHERE jenum = #{uid} 
			AND jabtag = 0
	</select>
	
	<!-- 도서별 원가계산서 인쇄 -->
	<select id="selBookCostStatement24" resultType="monthClosingVO">
		SELECT a.uid, a.crnum, a.bdate, a.m1, a.m2, a.m3, b.bnum, b.bname, b.bcode, b.bmyun, b.btype, c.SBPANH, c.SBJANH, c.SBSBJH1,c.SBSBJH2, 
			c.SBSBJH3, c.SBSBJH4, c.SBSBPH1, c.SBSBPH2, c.SBSBPH3, c.SBSBPH4, c.SBSBPG1, c.SBSBPG2, c.SBSBPG3, c.SBSBPG4, c.SBUPRC, d.wcname 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c, jejak.KSWCUST0 AS d 
		WHERE a.uid = #{uid}
			AND a.listid = b.uid 
			AND b.bcode = c.SBBOOK 
			AND a.m1 = d.wccode
	</select>
	
	<select id="selBookCostStatement25" resultType="monthClosingVO">
		SELECT a.*, b.bnum, b.bname, b.bcode, b.bmyun, b.btype, c.SBPANH, c.SBJANH, c.SBSBJH1, c.SBSBJH2, c.SBSBJH3, c.SBSBJH4, 
			c.SBSBPH1, c.SBSBPH2, c.SBSBPH3, c.SBSBPH4, c.SBSBPG1, c.SBSBPG2, c.SBSBPG3, c.SBSBPG4, c.SBUPRC, d.wcname 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c, jejak.KSWCUST0 AS d 
		WHERE a.bdate <![CDATA[ > ]]> #{date1} 
			AND a.bdate <![CDATA[ < ]]> #{date2}
			AND a.bucode = 0 
			AND a.listid = b.uid 
			AND b.bcode = c.SBBOOK 
			AND a.m1 = d.wccode 
		ORDER BY a.crnum ASC
	</select>
	
	<select id="selBookCostStatement26" resultType="monthClosingVO">		
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{uid} 
		ORDER BY uid ASC
	</select>
	
	<select id="selBookCostStatement27" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{bur_uid} 
		ORDER BY uid ASC
	</select>
	
	<select id="selBookCostStatement28" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{uid} 
			AND gubn like '%본문%'		
	</select>
	
	<select id="selBookCostStatement29" resultType="monthClosingVO">	
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{bur_uid} 
		ORDER BY uid ASC	
	</select>
	
	<select id="selBookCostStatement30" resultType="monthClosingVO">
		SELECT sbdung 
		FROM jejak.KSCBOOK0 
		WHERE sbbook LIKE #{bookcode}		
	</select>
	
	<select id="selBookCostStatement31" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TWONGA 
		WHERE jenum = #{uid}		
	</select>
	
	<select id="selBookCostStatement32" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST2 
		WHERE (date_format(from_unixtime(bdate), '%Y%m%d') = #{date}) 
		ORDER BY bdate ASC	
	</select>
	
	<select id="selBookCostStatement33" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{mrow}
			AND ycost = 0
	</select>
	
	<select id="selBookCostStatement34" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWJIJL0 
		WHERE wjcode = #{jcode}
	</select>
	 
	<update id="upBookCostStatement35" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST3 SET 
			ycost = #{new_cost} 
		WHERE uid = #{row}
	</update>
	
	<select id="selBookCostStatement36" resultType="monthClosingVO">
		SELECT a.uid, b.bcode, c.sbsbph1, c.sbsbph2, c.sbsbph3, c.sbsbph4 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c 
		WHERE a.uid = #{uid} 
			AND a.listid = b.uid 
			AND b.bcode = c.SBBOOK 
		LIMIT 1
	</select>
	
	<select id="selBookCostStatement37" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{bur_uid} 
			AND ycost = 0 
			AND bucode = #{i}
	</select>
	
	<update id="upBookCostStatement38" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST5 SET 
			pannum5 = #{pannum5}, filmnum5 = 0, filmcost5 = 0, daeji5 = #{daeji5}, sobu5 = #{sobu5}, sum5 = #{sum5} 
		WHERE uid = #{uid}
	</update>

	<select id="selBookCostStatement39" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE uid = #{uid}
	</select>
	
	<update id="upBookCostStatement40" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST5 SET 
			pannum5 = #{pannum5}, filmnum5 = #{filmnum5}, filmcost5 = #{filmcost5}, sobu5 = #{sobu5}, sum5 = #{sum5}, daeji5 = 0 
		WHERE uid = #{uid}
	</update>
	
	<select id="selBookCostStatement41" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE uid = #{uid}
	</select>
	
	<update id="upBookCostStatement42" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST3 SET 
			rnum = #{rnum}, pdanga = #{pdanga}, pcost = #{pcost} 
		WHERE uid = #{uid}
	</update>
	
	<select id="selBookCostStatement43" resultType="monthClosingVO">
		SELECT cnum7 
		FROM jejak.BITABLE7 
		WHERE uid = #{uid}
	</select>
	
	<update id="upBookCostStatement44" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE7 SET 
			cpage7 = #{cpage7}, cprice17 = #{cprice17}, cprice27 = #{cprice27}, pdanga7 = #{pdanga7}, totcost7 = #{totcost7} 
		WHERE uid = #{uid} 
	</update>
	
	<select id="selBookCostStatement45" resultType="monthClosingVO">
		SELECT A.listid, A.bdate, A.m2, B.bcode 
		FROM jejak.TMPLIST2 AS A, 
			jejak.TMPLIST AS B 
		WHERE A.uid = #{uid} 
			AND A.listid=B.uid
	</select>
	
	<update id="upBookCostStatement46" parameterType="monthClosingVO">
		INSERT INTO jejak.BITABLE8 (
			ccode8, bcode8, cdate8, cnum8, cprice8, totcost8, crnum8
		) VALUES (
			#{ccode8}, #{bcode8}, #{cdate8}, #{cnum8}, #{cprice8}, #{totcost8}, #{crnum8}
		) 
	</update>
	
	<delete id="delBookCostStatement47" parameterType="monthClosingVO">
		DELETE 
		FROM jejak.BITABLE8 
		WHERE uid=#{uid} 
	</delete>
	
	<update id="upBookCostStatement48" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE8 SET 
			cnum8 = #{cnum8}, cprice8 = #{cprice8}, totcost8 = #{totcost8} 
		WHERE uid = #{uid}
	</update>
	
	<select id="selBookCostStatement49" resultType="monthClosingVO">
		SELECT A.listid, A.bdate, A.m8, B.bcode, B.bnum 
		FROM jejak.TMPLIST2 AS A, 
			jejak.TMPLIST AS B 
		WHERE A.uid = #{uid} 
			AND A.listid = B.uid
	</select>
	
	<insert id="inBookCostStatement50" parameterType="monthClosingVO">
		INSERT INTO jejak.BITABLE9 (
			ccode9, bcode9, cdate9, cnum9, cprice9, bitag, crnum9
		) VALUES (
			#{ccode9}, #{bcode9}, #{cdate9}, #{cnum9}, #{cprice9}, 1, #{crnum9}
		)
	</insert>
	
	<update id="upBookCostStatement51" parameterType="monthClosingVO">
		UPDATE jejak.TWONGA SET 
			w1 = #{w1}, w2 = #{w2}, w3 = #{w3}, w4 = #{w4}, w5 = #{w5}, w6 = #{w6}, w7 = #{w7}, w8 = #{w8}, w9 = #{w9}, w11 = #{w11} 
		WHERE jenum=#{uid} 
			AND jabtag=0
	</update>
	
	<select id="selBookCostStatement52" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{uid} 
			AND bitag = 2
	</select>
	<select id="selBookCostStatement53" resultType="monthClosingVO">
		SELECT listid, m7, bdate 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement54" resultType="monthClosingVO">
		SELECT bcode, bnum 
		FROM jejak.TMPLIST 
		WHERE uid = #{listid}
	</select>
	
	<select id="selBookCostStatement55" resultType="monthClosingVO">
		SELECT m5 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement56" resultType="monthClosingVO">
		SELECT m6 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement57" resultType="monthClosingVO">
		SELECT m11 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement58" resultType="monthClosingVO">
		SELECT a.uid, a.crnum, a.bdate, a.m1, a.m2, a.m3, b.bnum, b.bname, b.bcode, b.bmyun, b.btype, c.sbpanh, c.sbjanh, c.sbsbjh1, c.sbsbjh2, 
			c.sbsbjh3, c.sbsbjh4, c.sbsbph1, c.sbsbph2, c.sbsbph3, c.sbsbph4, c.sbsbpg1, c.sbsbpg2, c.sbsbpg3, c.sbsbpg4, c.sbuprc, d.wcname 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c, jejak.KSWCUST0 AS d 
		WHERE a.uid = #{uid} 
			AND a.listid = b.uid 
			AND b.bcode = c.sbbook 
			AND a.m1 = d.wccode
	</select>
	
	<select id="selBookCostStatement59" resultType="monthClosingVO">
		SELECT A.listid, B.bname 
		FROM jejak.TMPLIST2 AS A, jejak.TMPLIST AS B 
		WHERE A.uid = #{uid} 
		AND A.listid = B.uid
	</select>
	
	<select id="selBookCostStatement60" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '인쇄' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement61" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '코팅' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement62" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '제본' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement63" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob	LIKE '스티커' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement64" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE 'CD' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement65" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '케이스' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement66" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '비닐' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement67" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '기타' 
			or wcjob LIKE '목형' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement68" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '목형' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement69" resultType="monthClosingVO">
		SELECT wccode, wcname 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE '증지' 
		ORDER BY wccode ASC
	</select>
	
	<select id="selBookCostStatement70" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST2 
		WHERE uid=#{uid}
	</select>
	
	<select id="selBookCostStatement71" resultType="monthClosingVO">
		SELECT listid 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement72" resultType="monthClosingVO">
		SELECT listid 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selBookCostStatement73" resultType="monthClosingVO">
		SELECT uid, bcode 
		FROM jejak.TMPLIST 
		WHERE uid = #{listid}
	</select>
	
	<select id="selBookCostStatement74" resultType="monthClosingVO">
		SELECT sbbook, sbuprc 
		FROM jejak.KSCBOOK0 
		WHERE sbbook LIKE #{sbbook} 
		ORDER BY sbbook DESC 
		LIMIT 1
	</select>
	
	<select id="selBookCostStatement75" resultType="monthClosingVO">
		SELECT A.*, B.bcode, B.bnum 
		FROM jejak.TMPLIST2 AS A, jejak.TMPLIST AS B 
		WHERE A.uid = #{uid} 
			AND A.listid = B.uid
	</select>
	
	<select id="selBookCostStatement76" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.PRINTNUM 
		WHERE bcode LIKE #{bcode} 
		ORDER BY pnum DESC 
		LIMIT 1
	</select>
	
	<select id="selBookCostStatement77" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCBOOK0 
		WHERE sbbook LIKE #{sbbook}
	</select>
	
	<select id="selBookCostStatement78" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.JEOJA 
		WHERE name1 LIKE #{name1}
	</select>
	
	<select id="selBookCostStatement79" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.JEOJA 
		WHERE name1 LIKE #{name1}
	</select>
		
	<insert id="inBookCostStatement1" parameterType="monthClosingVO">
		INSERT INTO jejak.BITABLE9 (
			ccode9, bcode9, cdate9, cnum9, cprice9, bitag, crnum9
		) VALUES (
			#{ccode9}, #{bcode9}, #{cdate9}, #{cnum9}, #{cprice9}, #{bitag}, #{crnum9}
		)
	</insert>
		
	<insert id="inBookCostStatement2" parameterType="monthClosingVO">
		INSERT INTO jejak.PRINTNUM (
			bcode, pnum, jnum
		) VALUES (
			#{bcode}, #{dbname2}, #{dbname3}
		)
	</insert>	
		
	<update id="upBookCostStatement1" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 
		SET cprice9 = #{w6}
		WHERE uid = #{uid}
	</update>
	
	<update id="upBookCostStatement2" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			cprice9 = #{cprice9}
		WHERE crnum9 = #{crnum9} 
			AND ccode9 LIKE #{ccode9} 
			AND bitag = 4
	</update>
	
	<update id="upBookCostStatement3" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			cprice9 = #{cprice9}
		WHERE crnum9 = #{crnum9}
			AND ccode9 LIKE #{ccode9} 
			AND bitag = 3
	</update>
	
	<update id="upBookCostStatement4" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			cprice9 = #{cprice9} 
		WHERE crnum9 = #{crnum9}
			AND ccode9 LIKE #{ccode9} 
			AND bitag = 4
	</update>
	
	<update id="upBookCostStatement5" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m1 = #{m1}
		WHERE listid = #{listid}
	</update>
	
	<update id="upBookCostStatement6" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE8 SET 
			ccode8 = #{ccode8} 
		WHERE crnum8 = #{crnum8}
	</update>
	
	<update id="upBookCostStatement7" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m2=#{m2} 
		WHERE listid = #{listid}		
	</update>
					
	<update id="upBookCostStatement8" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE7 SET 
			ccode7 = #{ccode} 
		WHERE crnum7 = #{crnum}
	</update>
					
	<update id="upBookCostStatement9" parameterType="monthClosingVO">
		UPDATE jejak.IBTABLE SET 
			m3 = #{m3}, ccode = #{ccode} 
		WHERE juid = #{juid}
	</update>
					
	<update id="upBookCostStatement10" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET
			m3 = #{m3}
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement11" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 4
	</update>
					
	<update id="upBookCostStatement12" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m5 = #{m5} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement13" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 3
	</update>
					
	<update id="upBookCostStatement14" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m6 = #{m6} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement15" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 2
	</update>				
	
	<update id="upBookCostStatement16" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m7 = #{m7} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement17" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 1
	</update>
					
	<update id="upBookCostStatement18" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m8 = #{m8} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement19" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 5
	</update>
	
	<update id="upBookCostStatement21" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m9=#{m9} 
		WHERE listid = #{listid}
	</update>				
					
	<update id="upBookCostStatement22" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE5 SET 
			ccode5 = #{ccode} 
		WHERE crnum5 = #{uid}
	</update>
					
	<update id="upBookCostStatement23" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 
			SET m10 = #{m10} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement24" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			ccode9 = #{ccode} 
		WHERE crnum9 = #{uid} 
			AND bitag = 4
	</update>
					
	<update id="upBookCostStatement25" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST2 SET 
			m11 = #{m11} 
		WHERE listid = #{listid}
	</update>
					
	<update id="upBookCostStatement26" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST SET 
			bcode = #{bcode}, bprice = #{bprice} 
		WHERE uid = #{uid}
	</update>
					
	<update id="upBookCostStatement27" parameterType="monthClosingVO">
		UPDATE jejak.IBTABLE SET 
			bookcode = #{bookcode} 
		WHERE juid = #{juid}
	</update>
					
	<update id="upBookCostStatement28" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE5 SET 
			bcode5 = #{bcode} 
		WHERE crnum5 = #{uid}
	</update>
					
	<update id="upBookCostStatement29" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE7 SET 
			bcode7 = #{bcode}
		WHERE crnum7 = #{uid}
	</update>
					
	<update id="upBookCostStatement30" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE8 SET 
			bcode8 = #{bcode} 
		WHERE crnum8 = #{uid}
	</update>				
	
	<update id="upBookCostStatement31" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			bcode9 = #{bcode}
		WHERE crnum9 = #{uid}
	</update>				
	
	<update id="upBookCostStatement32" parameterType="monthClosingVO">
		UPDATE jejak.BITABLE9 SET 
			bcode9 = #{bcode}
		WHERE crnum9 = #{uid}
	</update>				
	
	<!-- 잡물 원가계산서 -->
	<select id="selJMCostStatement1" resultType="monthClosingVO">
		SELECT count(uid) AS count 
		FROM jejak.TMPJAB 
		WHERE jbdate <![CDATA[ >= ]]> #{date1}
			AND jbdate <![CDATA[ <= ]]> #{date2}
	</select>
	
	<select id="selJMCostStatement2" resultType="monthClosingVO">
		SELECT uid, jbdate, jbname, jbamnt
		FROM jejak.TMPJAB 
		WHERE jbdate <![CDATA[ >= ]]> #{date1}
			AND jbdate <![CDATA[ <= ]]> #{date2}
		ORDER BY jbdate ASC
		LIMIT #{lm_s}, #{lm_t}
	</select>
	
	<select id="selJMCostStatement3" resultType="monthClosingVO">
		SELECT count(uid) AS yjtag
		FROM jejak.TMPJAB3 
		WHERE jbid = #{uid}
			AND ycost = 0 
			AND (jm > 0 OR yb > 0) 
			AND jutag <![CDATA[ < ]]> 3
	</select>
	
	<select id="selJMCostStatement4" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB 
		WHERE jbdate <![CDATA[ > ]]>  #{date1} 
			AND jbdate <![CDATA[ < ]]> #{date2}
		ORDER BY UID ASC
	</select>
	
	<select id="selJMCostStatement5" resultType="monthClosingVO">
		SELECT sobudan5, gubn5, panst5, sum(pannum5) AS pans, sum(sobu5) AS sobus, sum(sum5) AS sums, daeji5, filmnum5, filmdan5, filmcost5 
		FROM jejak.TMPJAB5 
		WHERE listid = #{uid} 
		GROUP BY gubn5 
		ORDER BY uid ASC
	</select>
	
	<select id="selJMCostStatement6" resultType="monthClosingVO">
		SELECT wcname 
		FROM jejak.KSWCUST0 
		WHERE wccode = #{m1}
	</select>
	
	<select id="selJMCostStatement7" resultType="monthClosingVO">
		SELECT yjcode, yjname, sum(jm) AS jms, sum(yb) AS ybs, gubn, colo, sum(rnum) AS rnums, sum(ycost) AS ycosts, sum(pcost) AS pcosts, pdanga 
		FROM jejak.TMPJAB3 
		WHERE jbid = #{uid} 
		GROUP BY gubn 
		ORDER BY uid ASC
	</select>
	
	<select id="selJMCostStatement8" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWCUST0 
		WHERE wccode = #{m3}
	</select>
	
	<select id="selJMCostStatement9" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB7 
		WHERE crnum7 = #{uid}
		ORDER BY uid ASC
	</select>
	
	<select id="selJMCostStatement10" resultType="monthClosingVO">
		SELECT a.*, b.wcname 
		FROM jejak.BIJAB8 AS a, jejak.KSWCUST0 AS b 
		WHERE a.crnum8 = #{uid} 
			AND a.ccode8 = b.wccode
	</select>
	
	<select id="selJMCostStatement11" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWCUST0 
		WHERE wccode = #{m8}
	</select>
	
	<select id="selJMCostStatement12" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE bitag = 1 
			AND ccode9 LIKE #{m8} 
			AND crnum9 = #{uid}
	</select>
	
	<select id="selJMCostStatement13" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TWONGA
		WHERE jenum = #{uid} 
			AND jabtag = 1
	</select>
	
	<select id="selJMCostStatement14" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB 
		WHERE uid = #{uid}
	</select>
	
	<select id="selJMCostStatement15" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB5 
		WHERE listid = #{uid} 
		ORDER BY uid ASC
	</select>
	
	<select id="selJMCostStatement16" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB3 
		WHERE jbid = #{uid} 
		ORDER BY uid ASC
	</select>
	
	<insert id="inJMCostStatement17" parameterType="monthClosingVO">
		INSERT INTO jejak.TWONGA (
			jenum, jabtag
		) VALUES (
			#{uid}, 1
		)
	</insert>
	
	<update id="upJMCostStatement18" parameterType="monthClosingVO">
		UPDATE jejak.TWONGA SET 
			wtotal = #{total_cost}, wdanga = #{total_danga} 
		WHERE jenum = #{uid} 
			AND jabtag = 1
	</update>
	
	
	<!-- 품목별 원재료명세서(월별) -->
	<select id="selPumMon1" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.YONGJIMS 
		WHERE msdate = #{msdate}
	</select>
	
	<select id="selPumMon2" resultType="monthClosingVO">
		SELECT wjcode 
		FROM jejak.KSWJIJL0 
		ORDER BY ib ASC, wjcode ASC
	</select>
	
	<select id="selPumMon3" resultType="monthClosingVO">
		SELECT a.*, b.wjname 
		FROM jejak.YONGJIMS AS a, jejak.KSWJIJL0 AS b 
		WHERE a.msdate = #{msdate}
			AND a.yjcode = b.wjcode 
		ORDER BY a.uid ASC
	</select>
	
	<!-- yj_ms2 -->
	<select id="selPumMon4" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWJIJL0 
		ORDER BY ib ASC, wjcode ASC
	</select>
	
	<select id="selPumMon5" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWJIJL0 
		ORDER BY ib ASC, wjcode ASC
	</select>
	
	<select id="selPumMon6" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.YONGJIMS 
		WHERE msdate LIKE #{bdate}
	</select>
	
	<select id="selPumMon7" resultType="monthClosingVO">
		SELECT jicode, sum(tprice) AS psum, sum(num) AS nsum 
		FROM jejak.JIINOUT 
		WHERE (date_format(from_unixtime(date), '%Y%m') = #{bdate}) 
			AND comment LIKE '入' 
		GROUP BY jicode
	</select>
	
	<select id="selPumMon8" resultType="monthClosingVO">
		SELECT uid 
		FROM jejak.TMPJAB 
		WHERE (date_format(from_unixtime(jbdate), '%Y%m') = #{bdate})
	</select>
	
	<select id="selPumMon9" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB3 
		WHERE jbid = #{uid}
			AND jutag <![CDATA[<>]]> 3
	</select>
	
	<select id="selPumMon10" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.YONGJIMS 
		WHERE msdate = #{bdate}
			AND yjcode = #{yjcode}
	</select>
	
	<select id="selPumMon11" resultType="monthClosingVO">
		SELECT uid 
		FROM jejak.TMPLIST2
		WHERE (date_format(from_unixtime(bdate), '%Y%m') = #{bdate})
	</select>
	
	<select id="selPumMon12" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{uid}
	</select>
	
	<select id="selPumMon13" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.YONGJIMS 
		WHERE msdate = #{bdate}
			AND yjcode = #{jcode}
	</select>
	
	<select id="selPumMon14" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.YONGJIMS 
		WHERE msdate = #{bdate}
	</select>
		
	<select id="selPumMon15" resultType="monthClosingVO">
		SELECT a.jbname, b.uid, b.ycost 
		FROM jejak.TMPJAB AS a, jejak.TMPJAB3 AS b 
		WHERE (date_format(from_unixtime(a.jbdate), '%Y%m') = #{bdate})
			AND a.uid = b.jbid 
			AND b.yjcode = #{yjcode} 
		ORDER BY a.uid ASC 
		LIMIT 1
	</select>	
	
	<!-- 확인 -->
	<select id="selPumMon16" resultType="monthClosingVO">
		SELECT a.listid, b.uid, b.ycost 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST3 AS b 
		WHERE (date_format(from_unixtime(a.bdate), '%Y%m') = #{bdate})
			AND a.uid = b.listid 
			AND b.jcode = #{yjcode}
		ORDER BY a.uid asc 
		LIMIT 1
	</select>	
	
	<insert id="inPumMon2" parameterType="monthClosingVO">
		INSERT INTO jejak.YONGJIMS (
			yjcode, msdate
		) VALUES (
			#{wjcode}, #{bdate}
		)
	</insert>
	
	<update id="upPumMon1" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty1 = 0, amnt1 = 0, qnty2 = 0, amnt2 = 0, qnty3 = 0, amnt3 = 0, qnty4 = 0, amnt4 = 0 
		WHERE msdate LIKE #{bdate}
	</update>
	
	<update id="upPumMon2" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty1 = #{qnty1}, amnt1 = #{amnt1} 
		WHERE yjcode = #{yjcode} 
			AND msdate = #{bdate}
	</update>
	
	<update id="upPumMon3" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty2 = #{nsum}, amnt2 = #{psum}
		WHERE yjcode = #{jicode}
			AND msdate = #{bdate}
	</update>
	
	<update id="upPumMon4" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty3 = #{new_q}, amnt3 = #{new_a} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon5" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty3 = #{new_q}, amnt3 = #{new_a} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon6" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty4 = #{new_q}, amnt4 = 0 
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon7" parameterType="monthClosingVO">
		UPDATE jejak.TMPJAB3 SET 
			ycost = #{new_a} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon8" parameterType="monthClosingVO">
		UPDATE jejak.TMPLIST3 SET 
			ycost = #{new_a} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon9" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			amnt3 = #{new_val}
		WHERE uid = #{uid}
	</update>
	
	<update id="upPumMon10" parameterType="monthClosingVO">
		UPDATE jejak.YONGJIMS SET 
			qnty4 = #{new_q}, amnt4 = #{new_a} 
		WHERE uid = #{uid}
	</update>
	<!-- yj_ms2 -->
	
	<insert id="inPumMon1" parameterType="monthClosingVO">
		INSERT INTO jejak.YONGJIMS (
			yjcode, msdate
		) 
		VALUES (
			#{yjcode}, #{msdate}
		)
	</insert>
	
	<!-- 품목별 원재료명세서(기간) -->
	<select id="selPumPer1" resultType="monthClosingVO">
		SELECT a.*, b.wjname 
		FROM jejak.YONGJIMS2 AS a, jejak.KSWJIJL0 AS b 
		WHERE a.msdate = #{msdate}
			AND a.yjcode = b.wjcode 
		ORDER BY a.uid ASC
	</select>
	
	<select id="selPumPer2" resultType="monthClosingVO">
		SELECT wjcode 
		FROM jejak.KSWJIJL0 
		ORDER BY ib ASC, wjcode ASC
	</select>
	
	<select id="selPumPer3" resultType="monthClosingVO">
		SELECT qnty1, amnt1 
		FROM jejak.YONGJIMS 
		WHERE yjcode LIKE #{yjcode} 
			AND msdate LIKE #{msdate}
	</select>
	
	<select id="selPumPer4" resultType="monthClosingVO">
		SELECT qnty1, amnt1 
		FROM jejak.YONGJIMS 
		WHERE yjcode LIKE #{yjcode} 
			AND msdate LIKE #{msdate}
	</select>
	
	<select id="selPumPer5" resultType="monthClosingVO">
		SELECT sum(qnty2) AS qnty2, sum(amnt2) AS amnt2, sum(qnty3) AS qnty3 , sum(amnt3) AS amnt3
		FROM jejak.YONGJIMS 
		WHERE yjcode LIKE #{yjcode}
			AND msdate <![CDATA[>=]]> #{tmon1}
			AND msdate <![CDATA[<=]]> #{tmon2}
	</select>
	
	<select id="selPumPer6" resultType="monthClosingVO">
		SELECT sum(qnty2) AS qnty2, sum(amnt2) AS amnt2, sum(qnty3) AS qnty3 , sum(amnt3) AS amnt3
		FROM jejak.YONGJIMS 
		WHERE yjcode LIKE #{yjcode}
			AND msdate <![CDATA[>=]]> #{tmon1}
			AND msdate <![CDATA[<=]]> #{tmon2}
	</select>

	<select id="selPumPer7" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.JIINOUT 
		WHERE jicode like #{yjcode} 
			and date <![CDATA[ >= ]]>  #{date1} 
			AND date <![CDATA[ <= ]]> #{date2}
			AND comment LIKE '入' 
		ORDER BY cdate ASC
	</select>
	
	<select id="selPumPer8" resultType="monthClosingVO">
		SELECT wcname 
		FROM jejak.KSWCUST0 
		WHERE wccode like #{wccode}
	</select>
	
	<insert id="inPumPer1" parameterType="monthClosingVO">
		INSERT INTO jejak.YONGJIMS2 (
			yjcode, msdate, qnty1, amnt1, qnty2, amnt2, qnty3, amnt3, qnty4, amnt4
		) VALUES (
			#{yjcode}, #{indate}, #{qnty1}, #{amnt1}, #{qnty2}, #{amnt2}, #{qnty3}, #{amnt3}, #{qnty4}, #{amnt4}
		)
	</insert>
	
	<delete id="delPumPer1" parameterType="monthClosingVO">
		DELETE 
		FROM jejak.YONGJIMS2 
		WHERE msdate LIKE #{bdate}
	</delete>
	
	<!-- 제조비명세표 -->
	<select id="selMCSpecification1" resultType="monthClosingVO">
		SELECT COUNT(uid) AS uid, substring(jmfield,1,2) AS jmfield 
		FROM jejak.KSWCUST0 
		WHERE jmfield NOT LIKE 'N' 
		GROUP BY substring(jmfield,1,2)
	</select>
	
	<select id="selMCSpecification2" resultType="monthClosingVO">
		SELECT ${dbattr} 
		FROM jejak.${dbname}
		WHERE jejodate LIKE #{bdate}
	</select>
	
	<select id="selMCSpecification3" resultType="monthClosingVO">
		SELECT SUM(CASE WHEN jabtag=0 THEN ${dbattr} ELSE 0 END) AS sum1, 
		 	SUM(CASE WHEN jabtag=1 THEN ${dbattr} ELSE 0 END) AS sum2 
	 	FROM jejak.${dbname}
	 	WHERE jejodate LIKE #{bdate}
	</select>
	
	<select id="selMCSpecification4" resultType="monthClosingVO">
		SELECT ${dbattr} 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate}
	</select>
	
	<select id="selMCSpecification5" resultType="monthClosingVO">
		SELECT ${dbattr} 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate}
	</select>
	
	<select id="selMCSpecification6" resultType="monthClosingVO">
		SELECT wcyakc 
		FROM jejak.KSWCUST0
		WHERE jmfield LIKE #{jmfield}
	</select>
	
	<select id="selMCSpecification7" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate} 
			AND jabtag = 0 
		ORDER BY jejosuns ASC
	</select>
	
	<select id="selMCSpecification8" resultType="monthClosingVO">
		SELECT sbinse 
		FROM jejak.KSCBOOK0 
		WHERE sbbook LIKE #{sbbook}
	</select>
	
	<select id="selMCSpecification9" resultType="monthClosingVO">
		SELECT w9 
		FROM jejak.TWONGA 
		WHERE jenum = #{jenum}
	</select>
	
	<select id="selMCSpecification10" resultType="monthClosingVO">
		SELECT SUM(${dbattr}) AS ${dbattr}
		FROM jejak.${dbname} 
		WHERE JEJODATE LIKE #{bdate} 
			AND JABTAG = 0
	</select>
	
	<select id="selMCSpecification11" resultType="monthClosingVO">
		SELECT SUM(s21) AS s21 
		FROM jejak.${dbname} 
		WHERE JEJODATE LIKE #{bdate} 
			AND JABTAG = 0
	</select>
	
	<select id="selMCSpecification12" resultType="monthClosingVO">
		SELECT SUM(yj1) AS yj1
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate} 
			AND jabtag = 0
	</select>
	
	<select id="selMCSpecification13" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate}
			AND jabtag = 2
	</select>
	
	<select id="selMCSpecification14" resultType="monthClosingVO">
		SELECT wccode 
		FROM jejak.KSWCUST0 
		WHERE jmfield LIKE 'ET%'
	</select>
	
	<select id="selMCSpecification15" resultType="monthClosingVO">
		SELECT jana 
		FROM jejak.CUSTJAN 
		WHERE custcode LIKE #{custcode} 
		AND mdate LIKE #{bdate}
		AND deduct = 0
	</select>
	
	<select id="selMCSpecification16" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname}
		WHERE jejodate LIKE #{bdate} 
			AND jabtag = 1 
		ORDER BY jejosuns ASC
	</select>
	
	<select id="selMCSpecification17" resultType="monthClosingVO">
		SELECT w9 
		FROM jejak.TWONGA 
		WHERE jenum = #{jenum} 
			AND jabtag = 1
	</select>
	
	<select id="selMCSpecification18" resultType="monthClosingVO">
		SELECT SUM(${dbattr}) AS ${dbattr} 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate} 
			AND jabtag = 1
	</select>
	
	<select id="selMCSpecification19" resultType="monthClosingVO">
		SELECT SUM(YJ1) AS yj1 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate} 
			AND jabtag = 1
	</select>
	
	<select id="selMCSpecification20" resultType="monthClosingVO">
		SELECT a.*, b.bname, b.bcode, b.bnum, c.sbsbph1, c.sbsbph2, c.sbsbph3, c.sbsbph4 
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c 
		WHERE a.bucode=0 
			AND a.bdate <![CDATA[ >= ]]> #{date1} 
			AND a.bdate <![CDATA[ <= ]]> #{date2} 
			AND a.listid = b.uid 
			AND b.bcode = c.sbbook 
		ORDER BY a.uid ASC
	</select>
	
	<select id="selMCSpecification21" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TWONGA 
		WHERE jenum = #{jenum} 
			AND jabtag = 0 
		LIMIT 1
	</select>
	
	<select id="selMCSpecification22" resultType="monthClosingVO">
		SELECT MAX(uid) AS uid
		FROM jejak.${dbname}
	</select>
	
	<select id="selMCSpecification23" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB3 
		WHERE jbid = #{uid}
	</select>
	
	<select id="selMCSpecification24" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST3 
		WHERE listid = #{uid}
	</select>
	
	<select id="selMCSpecification25" resultType="monthClosingVO">
		SELECT m1 
		FROM jejak.TMPLIST2 
		WHERE uid = #{uid}
	</select>
	
	<select id="selMCSpecification26" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification27" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{uid}
	</select>
	
	<select id="selMCSpecification28" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{uid}
	</select>
	
	<select id="selMCSpecification29" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE7 
		WHERE crnum7 = #{crnum7}
	</select>
	
	<select id="selMCSpecification30" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification31" resultType="monthClosingVO">
		SELECT bolist 
		FROM jejak.${dbname} 
		WHERE uid = #{uid}
	</select>
	
	<select id="selMCSpecification32" resultType="monthClosingVO">
		SELECT ${jbname} 
		FROM jejak.${dbname} 
		WHERE uid = #{uid}
	</select>
	
	<select id="selMCSpecification33" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE8 
		WHERE crnum8 = #{crnum8} 
			AND ccode8 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification34" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification35" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 1
	</select>
	
	<select id="selMCSpecification36" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode9}
	</select>
	
	<select id="selMCSpecification37" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 2
	</select>
	
	<select id="selMCSpecification38" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification39" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification40" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 3 
			AND cprice9 != 0
	</select>
	
	<select id="selMCSpecification41" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BITABLE9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 5
	</select>
	
	<select id="selMCSpecification42" resultType="monthClosingVO">
		SELECT w9 
		FROM jejak.TWONGA 
		WHERE jenum = #{jenum}
	</select>
	
	<select id="selMCSpecification43" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.CUSTJAN 
		WHERE mdate LIKE #{bdate} 
			AND jana <![CDATA[ > ]]> 0 
			AND deduct = 0
	</select>
	
	<select id="selMCSpecification44" resultType="monthClosingVO">
		SELECT jmfield 
		FROM jejak.KSWCUST0 
		WHERE wccode LIKE #{wccode}
	</select>
	
	<select id="selMCSpecification45" resultType="monthClosingVO">
		SELECT a.*, c.sbsbph1, c.sbsbph2, c.sbsbph3, c.sbsbph4 
		FROM jejak.TMPJAB AS a, jejak.KSCBOOK0 AS c 
		WHERE a.jbdate <![CDATA[ >= ]]> #{date1} 
			AND a.jbdate <![CDATA[ <= ]]> #{date2} 
			AND a.jbcode LIKE c.sbbook 
		ORDER BY a.uid ASC
	</select>
	
	<select id="selMCSpecification46" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TWONGA 
		WHERE jenum = #{jenum} 
			AND jabtag = 1 
		LIMIT 1
	</select>
	
	<select id="selMCSpecification47" resultType="monthClosingVO">
		select m1 
		FROM jejak.TMPJAB 
		WHERE uid = #{uid}
	</select>
	
	<select id="selMCSpecification48" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB5 
		WHERE LISTID = #{listid}
	</select>
	
	<select id="selMCSpecification49" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB7 
		WHERE crnum7 = #{crnum7} 
			AND ccode7 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification50" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB8 
		WHERE crnum8 = #{crnum8} 
			AND ccode8 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification51" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 1 
			AND ccode9 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification52" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 2 
			AND ccode9 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification53" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE crnum9 = #{crnum9}
			AND bitag = 4 
			AND cprice9 != 0 
			AND ccode9 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification54" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 3 
			AND cprice9 != 0 
			AND ccode9 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification55" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.BIJAB9 
		WHERE crnum9 = #{crnum9} 
			AND bitag = 5 
			AND ccode9 NOT LIKE 'N'
	</select>
	
	<select id="selMCSpecification56" resultType="monthClosingVO">
		SELECT COUNT(uid), substring(jmfield,1,2) 
		FROM jejak.KSWCUST0 
		WHERE jmfield NOT LIKE 'N' 
		GROUP BY substring(jmfield,1,2)
	</select>
	
	<select id="selMCSpecification57" resultType="monthClosingVO">
		SELECT SUM(${dbattr}) AS ${dbattr} 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate} 
		AND jabtag = 1
	</select>
	
	<select id="selMCSpecification58" resultType="monthClosingVO">
		SELECT COUNT(uid) AS uid 
		FROM jejak.${dbname} 
		WHERE jejodate LIKE #{bdate}
	</select>
	
	<select id="selMCSpecification59" resultType="monthClosingVO">
		SELECT wccode 
		FROM jejak.KSWCUST0 
		WHERE jmfield LIKE #{jmfield}
	</select>
	
	<select id="selMCSpecification60" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname} 
		WHERE ${dbattr} = #{uid} 
			AND ccode7 LIKE #{ccode}
	</select>
	
	<select id="selMCSpecification61" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.CUSTJAN 
		WHERE mdate = #{bdate} 
			AND custcode = #{custcode}
	</select>
	
	<select id="selMCSpecification62" resultType="monthClosingVO">
		SELECT uid, bolist 
		FROM jejak.${dbname} 
		WHERE jejonum = #{uid} 
			AND jabtag = 0
	</select>
	
	<select id="selMCSpecification63" resultType="monthClosingVO">
		SELECT * 
		FROM ${dbname} 
		WHERE ${dbattr} = #{uid} 
	</select>
	
	<select id="selMCSpecification64" resultType="monthClosingVO">
		SELECT * 
		FROM ${dbname} 
		WHERE ${dbattr} = #{uid} 
			AND bitag = #{bitag}
	</select>
	
	<select id="selMCSpecification65" resultType="monthClosingVO">
		SELECT uid, bolist 
		FROM jejak.${dbname}
		WHERE jejonum = #{jejonum} 
			AND jabtag = 1
	</select>
	
	<select id="selMCSpecification66" resultType="monthClosingVO">
		SELECT SUM(${dbname2}) AS #{dbname3} 
		FROM ${dbname} 
		WHERE jejodate LIKE #{bdate} 
		AND jabtag=1
	</select>
		
	<insert id="inMCSpecification1" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname} (
			uid, jejonum, jejodate, jejosuns, bookname, bookcode, jejoamnt, jejodang, s1, s2, s21, s3, s4, s5
		) VALUES (
			#{uid}, #{jejonum}, #{jejodate}, #{jejosuns}, #{bookname}, #{bookcode}, #{jejoamnt}, 
			#{jejodang}, #{s1}, #{s2}, #{s21}, #{s3}, #{s4}, #{s5}
		)
	</insert>
	
	<insert id="inMCSpecification2" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname} (
			uid, jejodate, bookcode, jejosuns, jabtag
		) VALUES (
		#{uid}, #{jejodate}, 'ZZZZZZ', 999, 2
		)
	</insert>
	
	<insert id="inMCSpecification3" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname} (
			uid, jejonum, jejodate, jejosuns, bookname, bookcode, jejoamnt, jejodang, s1, s2, s3, s4, s5, jabtag
		) VALUES (
			#{uid}, #{jejonum}, #{jejodate}, #{jejosuns}, #{bookname}, #{bookcode}, #{jejoamnt}, #{jejodang}, #{s1}, #{s2}, #{s3}, #{s4}, #{s5}, 1
		) 
	</insert>
	
	<insert id="inMCSpecification4" parameterType="monthClosingVO">
		INSERT jejak.CUSTJAN (
			custcode, mdate, jana
		) VALUES (
			#{custcode}, #{bdate}, #{jana}
		)
	</insert>
	
	<update id="upMCSpecification1" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			yj1 = #{yj1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification2" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{sum1} 
		WHERE uid = #{uid}
	</update>
	 
	<update id="upMCSpecification3" parameterType="monthClosingVO">
		UPDATE ${dbname} SET 
			#{dbattr} = #{name1}, bolist = #{bolist} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification4" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{name1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification5" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{sum1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification6" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{name1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification7" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{name1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification8" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			${dbattr} = #{name1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification9" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			sum1 = #{sum1}, bolist = #{bolist} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification10" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			boryu = #{dbattr} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upMCSpecification11" parameterType="monthClosingVO">
		UPDATE jejak.CUSTJAN SET 
			jana=#{jana} 
		WHERE uid=#{uid}
	</update>
	
	<update id="upMCSpecification12" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			bolist = #{bolist} 
		WHERE uid = #{uid}
	</update>
		
	<delete id="delMCSpecification1" parameterType="monthClosingVO">
		DELETE FROM jejak.${dbname}
		WHERE jejodate = #{jejodate}
	</delete>
	
	<delete id="delMCSpecification2" parameterType="monthClosingVO">
		DELETE 
		FROM jejak.CUSTJAN 
		WHERE uid = #{uid}
	</delete>
	
	<!-- 거래처별 지불명세서 -->
	<select id="selPaymentAccount1" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSWCUST0 
		WHERE wcjob LIKE #{dbattr} 
		ORDER BY wccode ASC
	</select>
	
	<select id="selPaymentAccount2" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname}
		WHERE ccode = #{ccode} 
			AND cdate <![CDATA[ > ]]> #{date1} 
			AND cdate <![CDATA[ < ]]> #{date2} 
		ORDER BY uid ASC
	</select>
	
	<select id="selPaymentAccount3" resultType="monthClosingVO">
		SELECT SUM(${jmfield}) AS jmfield 
		FROM jejak.${dbname} 
		WHERE jejodate = #{jejodate} 
			AND jabtag = #{dbattr}
	</select>
	
	<select id="selPaymentAccount4" resultType="monthClosingVO">
		SELECT jana 
		FROM jejak.CUSTJAN 
		WHERE mdate = #{bdate} 
		AND custcode = #{custcode} 
		AND deduct = #{dbattr}
	</select>
	
	<select id="selPaymentAccount5" resultType="monthClosingVO">
		SELECT SUM(tprice) AS sum1
		FROM jejak.JIINOUT 
		WHERE comid = #{comid} 
			AND date <![CDATA[ >= ]]> #{date1} 
			AND date <![CDATA[ <= ]]> #{date2}
	</select>
	
	<select id="selPaymentAccount6" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST2 
		WHERE m1 = #{m1} 
			AND bdate <![CDATA[ > ]]> #{date1} 
			AND bdate <![CDATA[ < ]]> #{date2} 
		ORDER BY uid ASC
	</select>
	
	<select id="selPaymentAccount7" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{listid5}
	</select>
	
	<select id="selPaymentAccount8" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPLIST5 
		WHERE listid5 = #{listid5}
	</select>
	
	<select id="selPaymentAccount9" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB 
		WHERE m1 = #{m1} 
			AND jbdate <![CDATA[ > ]]> #{date1} 
			AND jbdate <![CDATA[ < ]]> #{date2} 
		ORDER BY uid ASC
	</select>
	
	<select id="selPaymentAccount10" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.TMPJAB5 
		WHERE listid = #{dbattr}
	</select>
	
	<!-- 저자료 지급 내역(상/하) -->
	<select id="selRoyaltyUD1" resultType="monthClosingVO">
		SELECT a.sbname, a.sbbook, a.sbinse, a.sbhj04, a.sbhjgb, a.sbuprc
		FROM jejak.KSCBOOK0 AS a 
		WHERE a.sbjjgb = 1 
			AND a.${dbattr} <![CDATA[ > ]]> 0 
		ORDER BY a.sbbook ASC
	</select>
	
	<select id="selRoyaltyUD2" resultType="monthClosingVO">
		Select (
			SELECT sum(s1qnty) 
			FROM jejak.KS1${dbname}A 
			WHERE s1gubn = 'C' 
				AND s1book = #{sbbook}
			) AS sum1, (
			SELECT sum(s1qnty) 
			FROM jejak.KS1${dbname}A 
			WHERE s1gubn = 'D' 
				AND s1book = #{sbbook}
			) AS sum2
	</select>
	
	<select id="selRoyaltyUD3" resultType="monthClosingVO">
		SELECT distinct(sbjuja) 
		FROM jejak.KSCBOOK0 
		WHERE sbjjgb = 1 
			AND sbinse > 0 
		ORDER BY sbjuja ASC
	</select>
	
	<select id="selRoyaltyUD4" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCBOOK0 
		WHERE SBJUJA LIKE #{jname}
			AND sbjjgb = 1 
			AND sbinse > 0 
		ORDER BY sbbook ASC
	</select>
	
	<select id="selRoyaltyUD5" resultType="monthClosingVO">
		SELECT name2 
		FROM jejak.JEOJA 
		WHERE name1 LIKE #{jname}
	</select>
	
	<select id="selRoyaltyUD6" resultType="monthClosingVO">
		SELECT sum(s1qnty) AS s1qnty
		FROM jejak.${dbname} 
		WHERE s1gubn = 'C' 
			AND s1book = #{sbbook}
	</select>
	
	<select id="selRoyaltyUD7" resultType="monthClosingVO">
		SELECT sum(s1qnty) AS s1qnty 
		FROM jejak.${dbname} 
		WHERE s1gubn = 'D' 
			AND s1book = #{sbbook}
	</select>
	
	<select id="selRoyaltyUD8" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCBOOK0 
		WHERE SBJUJA 
		LIKE #{jname} 
			AND sbjjgb = 1 
			AND sbinse > 0 
		ORDER BY sbbook ASC
	</select>
	
	<select id="selRoyaltyUD9" resultType="monthClosingVO">
		SELECT sum(s1qnty) AS s1qnty 
		FROM jejak.${dbname} 
		WHERE s1gubn='C' 
			AND s1book=#{sbbook}
	</select>
	
	<select id="selRoyaltyUD10" resultType="monthClosingVO">
		SELECT sum(s1qnty) AS s1qnty 
		FROM jejak.${dbname} 
		WHERE s1gubn = 'D' 
			AND s1book = #{sbbook}
	</select>
	
	<select id="selRoyaltyUD11" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.JEOJA 
		WHERE name1 
		LIKE #{jname}
	</select>
	
	<!-- 월별 저자료 지출결의서 -->
	<select id="selMonthlyRoyalty" resultType="monthClosingVO">
		SELECT a.uid, b.bcode, b.bnum, c.sbinse, c.sbjjgb, c.sbjuja, c.sbuprc, c.sbbook, c.sbname
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b, jejak.KSCBOOK0 AS c
		WHERE (date_format(from_unixtime(a.bdate), '%Y%m') = #{bdate}) 
			AND a.listid = b.uid 
		    AND c.sbbook LIKE b.bcode
		    AND c.sbjjgb = 0
		    AND c.sbinse != 0
		ORDER BY a.bdate ASC
	</select>
	
	<!-- 저자료 지급 내역 ?? -->
	<select id="selRoyalty" resultType="monthClosingVO">
		SELECT a.sbinse, a.sbbook, a.sbname, a.sbuprc, a.sbhjgb,
		    (SELECT sum(s1qnty) FROM jejak.KS1${dbname}A WHERE s1gubn = 'C' AND s1book = a.sbbook) AS sum1,
		    (SELECT sum(s1qnty) FROM jejak.KS1${dbname}A WHERE s1gubn = 'D' AND s1book = a.sbbook) AS sum2
		FROM jejak.KSCBOOK0 AS a
		WHERE a.sbbook LIKE '12521%'
			OR a.sbbook LIKE '12522%'
			OR (a.sbbook <![CDATA[ >= ]]> '125340' AND a.sbbook <![CDATA[ <= ]]> '125390')
			OR (a.sbbook <![CDATA[ >= ]]> '125010' AND a.sbbook <![CDATA[ <= ]]> '125050')
			OR a.sbbook LIKE '31134%'
		ORDER BY a.sbbook ASC
	</select>
	
	<!-- 구매단가입력 -->
	<select id="selPurchasePrice1" resultType="monthClosingVO">
		SELECT uid 
		FROM jejak.HGJEON 
		WHERE ymd LIKE #{bdate}
	</select>
	
	<select id="selPurchasePrice2" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.IBTABLE2 
		WHERE idate 
		LIKE #{bdate}
		ORDER BY t1id ASC, idate ASC, uid2 ASC
	</select>
	
	<select id="selPurchasePrice3" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.IBTABLE 
		WHERE uid = #{uid}
	</select>
	
	<select id="selPurchasePrice4" resultType="monthClosingVO">
		SELECT jejoamnt, sum1 
		FROM jejak.${jejotbl} 
		WHERE jejonum = #{juid} 
			AND jabtag = 0
	</select>
	
	<select id="selPurchasePrice5" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.HGJEON 
		WHERE jeuid = #{juid} 
			AND ymd <![CDATA[ <= ]]> #{bdate}
	</select>
	
	<select id="selPurchasePrice6" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.GJEON2 
		WHERE paruid = #{uid}
	</select>
	
	<select id="selPurchasePrice7" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${tblname} 
		WHERE S1BOOK 
		LIKE #{bookcode} 
			AND s1qnty = #{inum}
			AND s1ilja LIKE #{idate} 
			AND s1gubn LIKE 'A'
	</select>
	
	<select id="selPurchasePrice8" resultType="monthClosingVO">
		SELECT max(seqno) 
		FROM jejak.HGJEON 
		WHERE ymd LIKE #{bdate} 
			AND jeuid = #{juid}
	</select>
	
	<select id="selPurchasePrice9" resultType="monthClosingVO">
		SELECT s1book, sum(s1qnty) AS s1qnty, sum(s1amnt) AS s1amnt
		FROM jejak.${dbname} 
		WHERE s1gubn LIKE 'A' 
		GROUP BY s1book 
		ORDER BY s1book ASC
	</select>
	
	<select id="selPurchasePrice10" resultType="monthClosingVO">
		SELECT sum(tbasr) AS asr, sum(tbbsr) AS bsr, sum(tbcsr) AS csr, sum(tbdsr) AS dsr, sum(tbesr) AS esr, sum(tbfsr) AS fsr 
		FROM jejak.${dbname} 
		WHERE tbsbook 
		LIKE #{bookcode} 
			AND tbmgubn <![CDATA[<]]> #{tbmgubn}
	</select>
	
	<select id="selPurchasePrice11" resultType="monthClosingVO">
		SELECT sum(tbakm) AS asr, sum(tbbkm) AS bsr, sum(tbckm) AS csr, sum(tbdkm) AS dsr, sum(tbekm) AS esr, sum(tbfkm) AS fsr 
		FROM jejak.${dbname} 
		WHERE tbkbook LIKE #{bookcode} 
			AND tbmgubn <![CDATA[ < ]]> #{tbmgubn}
	</select>
	
	<select id="selPurchasePrice12" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCIPDN0 
		WHERE sgbook 
		LIKE #{bookcode} 
			AND sgyyyy LIKE #{date1}
	</select>
	
	<select id="selPurchasePrice13" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname}
		WHERE (s1gubn LIKE 'E' OR s1gubn LIKE 'F')
	</select>
	
	<select id="selPurchasePrice14" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCIPDN0 
		WHERE sgbook LIKE #{s1book} 
			AND sgyyyy LIKE #{date1}
	</select>
	
	<insert id="inPurchasePrice1" parameterType="monthClosingVO">
		INSERT INTO jejak.HGJEON (
			ymd, seqno, acctcode, type, debit, credit, descript, inum, idanga, jeuid, fchk
		) VALUES (
			#{bdate}, #{seqno}, #{acctcode}, #{type}, #{debit}, #{credit}, #{descript}, #{inum}, #{idanga}, #{juid}, #{fchk}
		)
	</insert>
	
	<insert id="inPurchasePrice2" parameterType="monthClosingVO">
		INSERT INTO jejak.KSCIPDN0 (
			sgbook, sgyyyy, #{dbname}
		) VALUES (
			#{bookcode}, #{date1}, #{new_danga}
		)
	</insert>
	
	<update id="upPurchasePrice1" parameterType="monthClosingVO">
		UPDATE jejak.IBTABLE2 SET 
			idanga = #{new_danga} 
		WHERE uid2 = #{uid}
	</update>
	
	<update id="upPurchasePrice2" parameterType="monthClosingVO">
		UPDATE jejak.KSCIPDN0 SET 
			#{dbname} = #{new_danga} 
		WHERE sgbook LIKE #{bookcode} 
			AND sgyyyy LIKE #{date1}
	</update>
	
	<update id="upPurchasePrice3" parameterType="monthClosingVO">
		UPDATE jejak.${dbname} SET 
			s1dang = #{s1dang}, s1amnt = #{s1amnt} 
		WHERE uid = #{uid}
	</update>
	
	<delete id="delPurchasePrice1" parameterType="monthClosingVO">
		DELETE
		FROM jejak.HGJEON2 
		WHERE paruid = #{uid}
	</delete>
	
	<delete id="delPurchasePrice2" parameterType="monthClosingVO">
		DELETE 
		FROM jejak.HGJEON 
		WHERE ymd LIKE #{bdate}
	</delete>
	
	<!-- 도서 수량/금액 집계 -->
	<select id="selBookQuantityAmountTotal1" resultType="monthClosingVO">
		SELECT s1book, sum(s1qnty) AS sum1, sum(s1amnt) AS sum2, s1gubn 
		FROM jejak.${dbname} 
		GROUP BY s1book,s1gubn 
		ORDER BY s1book ASC, s1gubn ASC
	</select>
	
	<select id="selBookQuantityAmountTotal2" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname2} 
		WHERE tbsbook = #{s1book}
	</select>
	
	<select id="selBookQuantityAmountTotal3" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname3} 
		WHERE tbkbook = #{s1book}
	</select>
	
	<select id="selBookQuantityAmountTotal4" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname3} 
		WHERE tbkbook = #{s1book}
		AND tbmgubn = #{tm}
	</select>
	
	<select id="selBookQuantityAmountTotal5" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.kscipdn0 
		WHERE sgbook = #{s1book} 
		AND sgyyyy = #{ty};
	</select>
	
	<select id="selBookQuantityAmountTotal6" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.${dbname2} 
		WHERE tbsbook = #{s1book} 
		AND tbmgubn = #{tm}
	</select>
	
	<insert id="inBookQuantityAmountTotal1" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname2} (
			tbsbook, tbmgubn
		) VALUES (
			#{s1book}, #{tbmgubn}
		)
	</insert>
	
	<insert id="inBookQuantityAmountTotal2" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname2} (
			tbsbook, tbmgubn, ${fieldname}
		) VALUES (
			#{s1book}, #{tm}, #{sum1}
		)
	</insert>
	
	<insert id="inBookQuantityAmountTotal3" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname3} (
			tbkbook, tbmgubn
		) VALUES (
			#{s1book}, #{tbmgubn}
		)
	</insert>
	
	<update id="upBookQuantityAmountTotal1" parameterType="monthClosingVO">
		UPDATE jejak.${dbname2} SET 
			tbasr = 0, tbbsr = 0, tbcsr = 0, tbdsr = 0, tbesr = 0, tbfsr = 0
		WHERE tbmgubn = #{tm}
	</update>
	
	<update id="upBookQuantityAmountTotal2" parameterType="monthClosingVO">
		UPDATE jejak.${dbname3} SET 
			tbakm = 0, tbbkm = 0, tbckm = 0, tbdkm = 0,tbekm = 0, tbfkm = 0
		WHERE tbmgubn = #{tm}
	</update>
	
	<update id="upBookQuantityAmountTotal3" parameterType="monthClosingVO">
		UPDATE jejak.${dbname2} SET 
			${fieldname} = #{sum1} 
		WHERE uid = #{uid}
	</update>
	
	<update id="upBookQuantityAmountTotal4" parameterType="monthClosingVO">
		UPDATE jejak.${dbname3} SET 
			${fieldname} = #{sum2}
		WHERE tbkbook = #{s1book} 
			AND tbmgubn = #{tm}
	</update>
	
	<update id="upBookQuantityAmountTotal5" parameterType="monthClosingVO">
		UPDATE jejak.${dbname3} SET 
			${fieldname} = #{new_val}
		WHERE tbkbook = #{s1book} 
			AND tbmgubn = #{tm}
	</update>
		
	<!-- 도서금액집계 -->
	<select id="selBookAmountTotal1" resultType="monthClosingVO">
		SELECT s1book, sum(s1qnty) AS sum1, sum(s1amnt) AS sum2, s1gubn 
		FROM jejak.${dbname} 
		WHERE s1gubn <![CDATA[!=]]> 'A' 
		GROUP BY s1book,s1gubn 
		ORDER BY s1book ASC, s1gubn ASC
	</select>
	
	<select id="selBookAmountTotal2" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCIPDN0 
		WHERE sgbook = #{s1book}
			AND sgyyyy = #{ty}
	</select>
	
	<select id="selBookAmountTotal3" resultType="monthClosingVO">
		SELECT * 
		FROM jejak.KSCIPDN0 
		WHERE sgbook = #{s1book} 
			AND SGYYYY = #{tm}
	</select>
	
	<update id="upBookAmountTotal1" parameterType="monthClosingVO">
		UPDATE jejak.${dbname2} SET 
			TBAKM = #{sum2}
		WHERE tbkbook = #{s1book} 
			AND tbmgubn = #{tm}
	</update>
	
	<update id="upBookAmountTotal2" parameterType="monthClosingVO">
		UPDATE jejak.${dbname2} SET 
			${fieldname} = #{new_val}
		WHERE tbkbook = #{s1book} 
			AND tbmgubn = #{tm}
	</update>
	 
	<insert id="inBookAmountTotal1" parameterType="monthClosingVO">
		INSERT INTO jejak.${dbname2} (
			TBKBOOK, TBMGUBN
		) VALUES (
			#{s1book}, #{tm}
		)
	</insert>
	
	<!-- 주은교육 제작현황 -->
	<select id="selJueun" resultType="monthClosingVO">
		SELECT a.uid, a.bdate, a.crnum, a.bucode, b.bname, b.bcode, b.bnum , c.sbuprc, c.sbinse
		FROM jejak.TMPLIST2 AS a, jejak.TMPLIST AS b , jejak.KSCBOOK0 AS c
		WHERE a.bdate <![CDATA[ >= ]]> #{date1}
			AND a.bdate <![CDATA[ < ]]> #{date2}
			AND a.bucode = 0 
			AND a.listid=b.uid 
			AND b.bcode  <![CDATA[ >= ]]>  "125210"
			AND b.bcode  <![CDATA[ <= ]]>  "125391"
		    AND c.sbbook LIKE b.bcode
		ORDER BY a.crnum DESC
	</select>
</mapper>